Details of what I changed here when I can be bothered.